data{
  int N; //number of trials
  int y[N];//outcomes
}
parameters{
  real<lower=0,upper=1> a[N];
  real<lower=0,upper=1> b[N];
}

transformed parameters{
  real difference[N];
  simplex[3] theta[N];
  real threshold = .01;
  real p_err = .01;
  
    for(n in 1:N){
    difference[n] = a[n]-b[n];
    
    if(fabs(difference[n])<threshold){
        theta[n,1]=p_err/3;
        theta[n,2]=1-p_err+p_err/3;
        theta[n,3]=p_err/3;
    }else if(difference[n] < 0){
        theta[n,1]=1-p_err+p_err/3;
        theta[n,2]=p_err/3;
        theta[n,3]=p_err/3;
    }else{
        theta[n,1]=p_err/3;
        theta[n,2]=p_err/3;
        theta[n,3]=1-p_err+p_err/3;
    }
  }
}

model{
  a~beta(1,1);
  b~beta(1,1);
  for(n in 1:N){
    y~categorical(theta[n]);
      }
}
