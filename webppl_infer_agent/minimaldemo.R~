rm(list=ls())
library(ggplot2)
library(dplyr)
library(rwebppl)

exp.df <- read.csv("simexp.csv")

## bigness = 100
## trueprobs = c(1,2,7)
## exp.df <- data.frame(choice=c(rep(1,bigness),rep(2,bigness*2),rep(3,bigness*7)))

#data frames arrive in webppl as an array of objects, each object is a row, with attributes colnames holding the values in that row.
fit  <- webppl(program_file="model.ppl",data=exp.df,data_var="expdf")

inspection.df <- filter(fit, Parameter%in%c("data.0","data.1","data.2"))%>%transmute(Parameter=as.character(Parameter),value=as.numeric(value))


dfmeans.df <- data.frame(table(exp.df$choice)/nrow(exp.df))

ggplot(inspection.df, aes(x=value,group=Parameter,color=Parameter))+geom_density()+ geom_vline(data=dfmeans.df,aes(xintercept=Freq))
